var e=Object.defineProperty,t=(t,s,i)=>((t,s,i)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[s]=i)(t,"symbol"!=typeof s?s+"":s,i);import{d as s,r as i,a as o,S as n,w as a,o as l,f as r,U as d,V as h,W as c,F as u,X as p,Y as m,B as y,Z as v,c as g,_ as x,u as f,$ as b,a0 as w,G as M,a1 as z,E as S,R as P}from"./@vue-CHEtF9WB.js";import{P as N,a as C,D as k,b as H,H as O,R as j,S as L,A as G,c as _,C as U,g as A,G as V,V as E,d as J,e as I,W,f as B,O as D,h as R,i as F,M as T,j as q,k as $,l as K,T as X,m as Y,n as Z,o as Q,p as ee,q as te,r as se,s as ie,t as oe,B as ne,u as ae,v as le,w as re,E as de,x as he,y as ce}from"./three-B2X_Oofs.js";import{A as ue}from"./ant-design-vue-Bn0GRLdN.js";import"./@babel-CaN1A-4H.js";import"./@ant-design-ck12zdk4.js";import"./@ctrl-B2IeE8ye.js";import"./resize-observer-polyfill-CzGuHLZU.js";import"./@emotion-BqFXxR3o.js";import"./stylis-BXpgKhw9.js";import"./scroll-into-view-if-needed-NubnV8l_.js";import"./compute-scroll-into-view-DCNUDwgY.js";import"./vue-types-DUrkvkDc.js";import"./dom-align-CwhutA7q.js";import"./lodash-es-qFkpNywP.js";import"./dayjs-ClvOdu9v.js";import"./async-validator-D9c8kbAV.js";import"./throttle-debounce-w9OM8Bxz.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();class pe{init(e,t,s){const i={type:"PointLight",x:0,y:0,z:0,color:16777215,intensity:1e4,distance:0,decay:2,shadowWidth:1024,shadowHeight:1024,shadowNear:.5,shadowFar:1e3,lightHelper:!1,...s};let o;switch(i.type){case"PointLight":o=new N(i.color,i.intensity,i.distance,i.decay),i.lightHelper&&e.add(new C(o,10));case"AmbientLight":o=new G(i.color,i.intensity);case"SpotLight":o=new L(i.color,i.intensity);case"RectAreaLight":o=new j(i.color,i.intensity);case"HemisphereLight":o=new O(i.color,i.color,i.intensity);case"DirectionalLight":o=new k(i.color,i.intensity),i.lightHelper&&e.add(new H(o,5));default:if(o=new N(i.color,i.intensity,i.distance,i.decay),i.lightHelper){const t=new C(o,10);e.add(t)}}o.position.set(i.x,i.y,i.z),o.castShadow=!0,e.add(o),o.shadow.mapSize.width=i.shadowWidth,o.shadow.mapSize.height=i.shadowHeight,o.shadow.camera.near=i.shadowNear,o.shadow.camera.far=i.shadowFar;const n=t.addFolder(i.type);return n.close(),n.add(o,"intensity",0,1e4,1),n.add(o.position,"x",-1e3,1e3,1),n.add(o.position,"y",-1e3,1e3,1),n.add(o.position,"z",-1e3,1e3,1),o}}class me{constructor(){t(this,"scene"),t(this,"camera"),t(this,"innerWidth",0),t(this,"innerHeight",0),t(this,"renderer"),t(this,"controls"),t(this,"clock"),t(this,"stats"),t(this,"gui"),t(this,"axesHelper",new _(150)),this.clock=new U,this.gui=new A,this.gui.close()}gridHelper(e=1e3,t=10){var s;const i=new V(e,t);null==(s=this.scene)||s.add(i)}onResize(){this.camera.aspect=window.innerWidth/window.innerHeight}light(e={}){return(new pe).init(this.scene,this.gui,e)}init(e,t=new E(0,10,20)){const s=document.querySelector(e);this.innerWidth=(null==s?void 0:s.clientWidth)||0,this.innerHeight=(null==s?void 0:s.clientHeight)||0,this.scene=new J,this.camera=new I(75,innerWidth/innerHeight,.1,2e3),this.camera.position.copy(t),this.renderer=new W({antialias:!0}),this.renderer.setSize(this.innerWidth,this.innerHeight),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=B,this.scene.add(this.axesHelper),this.controls=new D(this.camera,this.renderer.domElement),window.onresize=()=>{this.innerWidth=(null==s?void 0:s.clientWidth)||0,this.innerHeight=(null==s?void 0:s.clientHeight)||0,console.log(this.innerWidth,this.innerHeight),this.camera.aspect=this.innerWidth/this.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.innerWidth,this.innerHeight)},console.log(this.innerWidth,this.innerHeight),null==s||s.appendChild(this.renderer.domElement),this.stats=new R}plane(){var e;const t=new F(100,100),s=new T({color:65280,side:q}),i=new $(t,s);i.rotation.x=Math.PI/2,null==(e=this.scene)||e.add(i)}destroy(){var e,t,s;null==(e=this.renderer)||e.dispose(),null==(t=this.scene)||t.traverse((e=>{var t;null==(t=this.scene)||t.remove(e)})),null==(s=this.camera)||s.remove()}}const ye=e=>{Xe.config.globalProperties.$progressLoading.onProgress(e)},ve=()=>{Xe.config.globalProperties.$progressLoading.onShow()},ge=()=>{Xe.config.globalProperties.$progressLoading.onHide()};var xe=(e=>(e.BoxGeometry="BoxGeometry",e.ModelGlb="modelGlb",e.ModelGltf="modelGltf",e.Image="image",e.Video="video",e))(xe||{});class fe{constructor(){t(this,"lines",[]),t(this,"lineMap",new Map),t(this,"current",0),t(this,"oldUuid",""),t(this,"newUuid","")}add(e,t){this.lines.length&&(this.lines.length=this.current+1),this.lines.push({uuid:e,message:t}),this.current=this.lines.length-1}sort(e){let t={position:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0},scale:{x:0,y:0,z:0},size:{x:0,y:0,z:0},name:"",type:"BoxGeometry",url:"",visible:!1};const s=[];for(let i=0;i<this.lines.length;i++)this.lines[i].uuid===e?t=this.lines[i].message:s.push(this.lines[i]);s.push({uuid:e,message:t}),this.lines.length=0,this.lines.push(...s)}next(){return this.current<this.lines.length-1&&this.current++,this.newUuid=this.lines[this.current].uuid,this.lines[this.current]}prev(){return this.oldUuid=this.lines[this.current].uuid,this.current>0&&this.current--,this.lines[this.current]}removeChild(){return this.lines.slice(0,this.current+1).some((e=>e.uuid===this.oldUuid))?"":this.oldUuid}addChild(){return this.lines.slice(0,this.current+1).some((e=>e.uuid===this.newUuid))?this.newUuid:""}}const be=[{name:"图片",type:"image",url:"./texture/images/uv_grid_opengl.jpg",uuid:"c86649a1-5050-4325-be9a-f7fbf2eddc27",position:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0},scale:{x:2,y:1,z:1},size:{x:0,y:0,z:0},visible:!0},{name:"模型gltf",type:"modelGltf",url:"./texture/model/LeePerrySmith.glb",uuid:"fe841ffd-2b55-495d-b451-451afa7a503a",mixer:[],position:{x:14.653004919197528,y:-36.66009163661538,z:-20.043370080310176},rotation:{x:0,y:0,z:0},scale:{x:1,y:1.0000001192092896,z:1.0000001192092896},size:{x:0,y:0,z:0},visible:!0},{name:"视频",type:"video",url:"./texture/video/sintel.mp4",uuid:"80f1f56f-47de-43f9-8689-7f15f8fc268d",position:{x:-11.413523111868496,y:4.9940120911203865,z:0},rotation:{x:0,y:0,z:0},scale:{x:1,y:1,z:1},size:{x:0,y:0,z:0},visible:!0},{name:"模型glb",type:"modelGlb",url:"./texture/model/Soldier.glb",uuid:"a813486e-ae40-4373-b154-fa65ede7323c",mixer:["Idle","Run","TPose","Walk"],position:{x:-13.37227955350931,y:0,z:0},rotation:{x:-1.5707962925663537,y:0,z:0},scale:{x:.009999999776482582,y:.009999999776482582,z:.009999999776482582},size:{x:0,y:0,z:0},visible:!0}];class we{constructor(e,s){var i,o;t(this,"onDownPosition",new Z),t(this,"onUpPosition",new Z),t(this,"dom"),t(this,"onMouseDown",(e=>{var t;const s=null==(t=this.dom)?void 0:t.getBoundingClientRect();this.onDownPosition.x=e.offsetX/s.width*2-1,this.onDownPosition.y=-e.offsetY/s.height*2+1})),t(this,"onMouseUp",(e=>{var t,s;const i=null==(t=this.dom)?void 0:t.getBoundingClientRect(),o=[(e.clientX-i.left)/i.width,(e.clientY-i.top)/i.height];this.onUpPosition.fromArray(o),this.onDownPosition.distanceTo(this.onUpPosition),null==(s=this.dom)||s.removeEventListener("mouseup",this.onMouseUp)})),this.dom=document.querySelector(e),null==(i=this.dom)||i.addEventListener("mousedown",this.onMouseDown),null==(o=this.dom)||o.addEventListener("mouseup",(e=>{var t;const i=null==(t=this.dom)?void 0:t.getBoundingClientRect();this.onUpPosition.x=e.offsetX/i.width*2-1,this.onUpPosition.y=-e.offsetY/i.height*2+1,0===this.onDownPosition.distanceTo(this.onUpPosition)&&s(this.onUpPosition)}))}}const Me={class:"left"},ze=["data-type","data-index"],Se=["data-type"],Pe={class:"right"},Ne={class:"tab-container"},Ce={class:"message"},ke={class:"animation"},He=["data-name"],Oe={class:"object-container"},je=["data-index","data-uuid","data-type"],Le={class:"drag-container"},Ge=["data-type","data-url","data-name"],_e={key:0,class:"video-control"},Ue={class:"control-list"},Ae={class:"restore-revoke"},Ve={class:"restore"},Ee={class:"revoke"},Je={class:"export"},Ie=(e,t)=>{const s=e.__vccOpts||e;for(const[i,o]of t)s[i]=o;return s},We=Ie(s({__name:"Index",setup(e){const s=new fe,z=i("0"),S=[{name:"模型glb",type:xe.ModelGlb,url:"./texture/model/Soldier.glb"},{name:"模型gltf",type:xe.ModelGltf,url:"./texture/model/LeePerrySmith.glb"},{name:"图片",type:xe.Image,url:"./texture/images/uv_grid_opengl.jpg"},{name:"视频",type:xe.Video,url:"./texture/video/sintel.mp4"}],P=i(-1);let N=0;const C=[{type:"translate",name:"移动"},{type:"scale",name:"缩放"},{type:"rotate",name:"旋转"}],k=[{type:"delete",name:"删除"}],H=i(!1),O=i(-1),j=o({position:{type:"position",x:0,y:0,z:0},rotation:{type:"rotation",x:0,y:0,z:0},scale:{type:"scale",x:0,y:0,z:0}}),L=o([]),G=i(-1);let _="";const U=n([]),A=i(""),V=e=>{var t;U.length=0,(null==(t=L[e])?void 0:t.mixer)&&U.push(...L[e].mixer)},J=i(),I=i(),W={name:"",type:"BoxGeometry",url:""},B=i(!1),D=i(!1),R=i(!0);i(0);const ue=new class extends me{constructor(){super(),t(this,"meshGroup",new Q),t(this,"raycasting",new ee),t(this,"pointer",new Z),t(this,"transformControls"),t(this,"selectGroup",new Q),t(this,"selectMesh"),t(this,"gizmo"),t(this,"mixer"),t(this,"modelList",new Q),t(this,"mixerArray",[]),t(this,"boxHelper"),t(this,"prev",(()=>{const e=s.prev();console.log("prev",s.current,e),this.updateMeshMessage(e);const t=s.removeChild();this.setMeshVisible(t,!1),this.restore(e.uuid)})),t(this,"next",(()=>{const e=s.next();console.log("next",s.current,e),this.updateMeshMessage(e);const t=s.addChild();this.setMeshVisible(t,!0)}))}load(){var e,t;this.init("#webgl");const s=new te(this.renderer);this.scene.background=new se(3355443),this.scene.environment=s.fromScene(new ie,.04).texture,null==(e=this.scene)||e.add(this.meshGroup,this.selectGroup),this.transformControls=new oe(this.camera,this.renderer.domElement),this.animate();let i=2*Math.tan(this.camera.fov*Math.PI/180/2)*this.camera.position.z*this.camera.aspect;console.log("screenSpaceWidth",i),null==(t=this.controls)||t.addEventListener("change",(()=>{i=2*Math.tan(this.camera.fov*Math.PI/180/2)*this.camera.position.z*this.camera.aspect,console.log("screenSpaceWidth",i)})),this.gridHelper(1e3,200),this.transformControls.addEventListener("dragging-changed",(e=>{this.controls.enabled=!e.value,console.log("dragging-changed",e),pe.value=e.value,e.value||(this.meshInformation(this.selectMesh).then((e=>{const t=L[G.value];this.addLine(t.uuid,JSON.parse(JSON.stringify(e.position)),JSON.parse(JSON.stringify({x:e.rotation.x,y:e.rotation.y,z:e.rotation.z})),JSON.parse(JSON.stringify(e.scale)),this.selectMesh.visible,{name:t.name,type:t.type,url:t.url})})),this.getSelectMeshInfo())})),this.transformControls.addEventListener("pointEnd-changed",(e=>{console.log("pointEnd-changed",e)})),this.transformControls.addEventListener("change",(e=>{})),new we("#webgl",(e=>{var t;this.pointer.x=e.x,this.pointer.y=e.y,this.raycasting.setFromCamera(this.pointer,this.camera);const s=this.raycasting.intersectObjects(this.meshGroup.children);if(console.log("pointer",s),s.length){let e=s[0].object.uuid||"";if("SkinnedMesh"===s[0].object.type){const i=s[0].object,o=i.skeleton.bones[0];this.selectMesh=o,e=(null==(t=i.parent)?void 0:t.uuid)||"";const n=this.setSelectMeshIndex(e);this.setSelectMesh(this.meshGroup.children[n])}else this.selectMesh=s[0].object,this.setSelectMesh(this.selectMesh),this.setSelectMeshIndex(e);this.getSelectMeshInfo()}else-1==G.value&&this.gizmo}))}setMode(e){var t,s;console.log("设置控制的模式",this.transformControls),(null==(t=this.transformControls)?void 0:t.object)&&(null==(s=this.transformControls)||s.setMode(e))}addObject(e){if(e.type===xe.BoxGeometry){const e=new T({color:16777215}),t=new ne(5,5,5),s=new $(t,e);s.position.set(0,2.5,0),this.meshGroup.add(s)}else e.type===xe.ModelGlb||e.type===xe.ModelGltf?this.addModel(e):e.type===xe.Image?this.addImage(e):e.type===xe.Video&&this.addVideo(e)}addModel(e){var t;(t=e.url,new Promise((e=>{ve(),(new K).load(t,(t=>{e(t),ge()}),(e=>{console.log(e.total/e.loaded),ye(Number((e.total/e.loaded).toFixed(2)))}),(e=>{console.log(e),ge()}))}))).then((t=>{const s=t.scene.children[0];this.createAnimationMixer(t,s.uuid).then((t=>{this.setMeshListPush(e,s)})),this.meshGroup.add(s)}))}addImage(e){var t;(t=e.url,new Promise((e=>{ve(),(new X).load(t,(t=>{const{width:s,height:i}=t.source.data;e({width:s,height:i,texture:t}),ge()}),(e=>{console.log(e.total/e.loaded),ye(Number((e.total/e.loaded).toFixed(2)))}),(e=>{console.log(e),ge()}))}))).then((t=>{const{width:s,height:i,texture:o}=t,n=new F(10,10*i/s),a=new T({map:o,side:q,transparent:!0}),l=new $(n,a);this.meshGroup.add(l),this.setMeshListPush(e,l)}))}addVideo(e){var t;(t=e.url,new Promise((e=>{ve();const s=document.createElement("video");s.src=t,s.crossOrigin="Anonymous",s.loop=!0,s.muted=!0,s.pause(),s.onloadeddata=()=>{ge();const t=new Y(s),{videoWidth:i,videoHeight:o}=s;e({videoWidth:i,videoHeight:o,texture:t})},s.onerror=()=>{ge(),console.log("视频加载失败")}}))).then((t=>{const{videoWidth:s,videoHeight:i,texture:o}=t,n=new F(10,10*i/s),a=new T({map:o,side:q,transparent:!0}),l=new $(n,a);this.meshGroup.add(l),this.setMeshListPush(e,l)}))}setMeshListPush(e,t){let s;e.uuid?s=this.setMeshMatrix(t,e):(s=t,this.addLine(s.uuid,s.position,s.rotation,s.scale,s.visible,e)),L.push({...e,uuid:s.uuid,position:s.position,rotation:{x:s.rotation.x,y:s.rotation.y,z:s.rotation.z},scale:s.scale,size:{x:0,y:0,z:0}})}lineSort(e,t){s.lines.length===t&&s.sort(e)}addLine(e,t,i,o,n,a){s.add(e,{position:JSON.parse(JSON.stringify(t)),rotation:JSON.parse(JSON.stringify(i)),scale:JSON.parse(JSON.stringify(o)),size:{x:0,y:0,z:0},visible:n,...a})}createAnimationMixer(e,t){return new Promise((s=>{if(e.animations.length){const i=e.scene,o=new ae(i),n=[];let a=[];e.animations.forEach((e=>{const t=o.clipAction(e);a.push(t),n.push(e.name)})),this.mixerArray.push({uuid:t,mixer:o,action:a}),s(n)}else s([])}))}playAnimation(e){console.log("name",e,_,this.mixerArray),this.mixerArray.forEach((t=>{t.uuid===_&&t.action.forEach(((t,s)=>{const i=t.getClip().name;i===e?(t.play(),A.value=i):t.stop()}))}))}getAnimationName(){this.mixerArray.forEach((e=>{e.uuid===_&&e.action.forEach(((e,t)=>{const s=e.getClip().name;e.isRunning()&&(A.value=s)}))}))}getSelectMeshInfo(){this.meshInformation(this.selectMesh),this.selectMesh instanceof le?this.getMeshSize(this.selectMesh.parent):this.getMeshSize(this.selectMesh)}meshInformation(e){return new Promise((t=>{j.position.x=e.position.x,j.position.y=e.position.y,j.position.z=e.position.z,j.rotation.x=e.rotation.x,j.rotation.y=e.rotation.y,j.rotation.z=e.rotation.z,j.scale.x=e.scale.x,j.scale.y=e.scale.y,j.scale.z=e.scale.z,t({position:e.position,rotation:e.rotation,scale:e.scale})}))}getMeshSize(e){return new Promise((t=>{if(e.children.length)e.traverse((e=>{if(e instanceof $){e.geometry.computeBoundingBox();const{max:t,min:s}=e.geometry.boundingBox||{max:new E,min:new E};(new re).setFromPoints([s,t]).getSize(new E)}}));else{e.geometry.computeBoundingBox();const{max:t,min:s}=e.geometry.boundingBox||{max:new E,min:new E};(new re).setFromPoints([s,t]).getSize(new E)}}))}setMeshMatrix(e,t){return e.position.copy(new E(t.position.x,t.position.y,t.position.z)),e.rotation.copy(new de(t.rotation.x,t.rotation.y,t.rotation.z)),e.scale.copy(new E(t.scale.x,t.scale.y,t.scale.z)),console.log(L),e}setMeshPosition(e){var t;null==(t=this.selectMesh)||t.position.copy(e)}setMeshRotate(e){var t;const{x:s,y:i,z:o}=e,n=new de(s,i,o);null==(t=this.selectMesh)||t.rotation.copy(n)}setMeshScale(e){var t;null==(t=this.selectMesh)||t.scale.copy(e)}setSelectMeshIndex(e){const t=G.value=L.findIndex((t=>t.uuid===e));return V(t),_=e,A.value="",this.getAnimationName(),this.setVideoControlVisible(L[t].type),t}setSelectMesh(e){var t,s,i,o;let n;n="string"==typeof e?this.meshGroup.getObjectByProperty("uuid",e):(e.type,e),this.selectMesh=n,null==(t=this.scene)||t.remove(this.boxHelper),this.boxHelper=new he(n,16776960),this.boxHelper.name="boxHelper",null==(s=this.scene)||s.add(this.boxHelper),this.transformControls.attach(n),-1!==P.value&&this.transformControls.setMode(C[P.value].type),this.gizmo||(this.gizmo=null==(i=this.transformControls)?void 0:i.getHelper(),null==(o=this.scene)||o.add(this.gizmo)),P.value=N}moveTargetPosition(){var e,t;if(this.selectMesh){const s=new E(0,0,0).copy(this.selectMesh.position).subVectors(new E(0,10,20),this.selectMesh.position);this.camera.lookAt(0,0,0),this.camera.position.copy(s),null==(e=this.controls)||e.target.set(0,0,0),null==(t=this.controls)||t.update()}}remove(){var e;if(this.selectMesh){this.selectMesh.visible=!1,null==(e=this.transformControls)||e.detach();const t=L[G.value];t.visible=!1,G.value=-1,console.log("删除几何体",t,this.selectMesh),this.addLine(this.selectMesh.uuid,JSON.parse(JSON.stringify(this.selectMesh.position)),JSON.parse(JSON.stringify({x:this.selectMesh.rotation.x,y:this.selectMesh.rotation.y,z:this.selectMesh.rotation.z})),JSON.parse(JSON.stringify(this.selectMesh.scale)),this.selectMesh.visible,{name:t.name,type:t.type,url:t.url})}else alert("请选择几何体")}restore(e){L.forEach((t=>{t.uuid===e&&!1===t.visible&&(t.visible=!0)})),this.setMeshVisible(e,!0)}setMeshVisible(e,t){e&&this.meshGroup.traverse((s=>{s.uuid===e&&(s.visible=t)}))}updateMeshMessage(e){const{uuid:t,message:s}=e;this.meshGroup.traverse((e=>{e.uuid===t&&(e.position.copy(s.position),new E,e.rotation.copy(new de(s.rotation.x,s.rotation.y,s.rotation.z)),e.scale.copy(s.scale),console.log("updateMeshMessage",e.uuid,e.rotation))}))}exportData(){const e=L.filter((e=>e.visible));console.log("export",e)}setVideoControlVisible(e){e===xe.Video?B.value=!0:B.value=!1}setVideoPlay(){var e;const t=null==(e=this.meshGroup.children[G.value].material.map)?void 0:e.source.data;t.paused?t.play():t.pause(),D.value=!t.paused}setVideoMuted(){var e;const t=null==(e=this.meshGroup.children[G.value].material.map)?void 0:e.source.data;t.muted=!t.muted,R.value=t.muted}animate(){var e,t;if(null==(e=this.stats)||e.begin(),requestAnimationFrame((()=>{this.animate()})),ce.update(),this.renderer.render(this.scene,this.camera),this.mixerArray.length){const e=this.clock.getDelta();this.mixerArray.forEach((t=>{t.mixer.update(e)}))}null==(t=this.stats)||t.end()}},pe=i(!1);a(j,((e,t)=>{pe.value||(ue.setMeshPosition(new E(Number(e.position.x),Number(e.position.y),Number(e.position.z))),ue.setMeshRotate(new E(Number(e.rotation.x),Number(e.rotation.y),Number(e.rotation.z))),ue.setMeshScale(new E(Number(e.scale.x),Number(e.scale.y),Number(e.scale.z))))}));const Ie=(e,t)=>{"position"===t?ue.setMeshPosition(new E(Number(j.position.x),Number(j.position.y),Number(j.position.z))):"rotation"===t?ue.setMeshRotate(new E(Number(j.rotation.x),Number(j.rotation.y),Number(j.rotation.z))):"scale"===t&&ue.setMeshScale(new E(Number(j.scale.x),Number(j.scale.y),Number(j.scale.z))),ue.addLine(L[G.value].uuid,JSON.parse(JSON.stringify(j.position)),JSON.parse(JSON.stringify(j.rotation)),JSON.parse(JSON.stringify(j.scale)),!0,{name:L[G.value].name,type:L[G.value].type,url:L[G.value].url})},We=e=>{const{dataset:t}=e.target;P.value=-1,"delete"===t.type?ue.remove():"targetPosition"===t.type?(ue.moveTargetPosition(),O.value=1!=O.value?1:-1):(ue.setMode(t.type),P.value=Number(t.index),N=Number(t.index))},Be=e=>{const{dataset:t}=e.target;G.value=Number(t.index),ue.setSelectMesh(t.uuid),t.uuid,V(G.value),_=t.uuid,ue.getAnimationName(),ue.setVideoControlVisible(t.type)},De=e=>{const{dataset:t}=e.target,s=t.name;ue.playAnimation(s)},Re=e=>{const{dataset:t}=e.target;W.name=t.name||"",W.type=t.type,W.url=t.url||"",pe.value=!0},Fe=e=>{const t={uuid:"",position:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0},scale:{x:0,y:0,z:0},size:{x:0,y:0,z:0},name:W.name,type:W.type,url:W.url,visible:!0};ue.addObject(t),H.value=!0,pe.value=!1};return l((()=>{ue.load(),H.value=!0;for(let e=0;e<be.length;e++)console.log(be[e]),ue.addObject(be[e])})),r((()=>{ue.gui.close(),ue.gui.destroy()})),(e,t)=>{const s=d("a-input"),i=d("a-space"),o=d("a-tab-pane"),n=d("a-tabs"),a=d("a-button");return c(),h(u,null,[p("div",{id:"webgl",ref_key:"webglRef",ref:I,onDragover:t[0]||(t[0]=y((()=>{}),["prevent"])),onDrop:Fe},null,544),p("div",Me,[H.value?(c(),h("div",{key:0,class:"list",onClick:We},[(c(),h(u,null,v(C,((e,t)=>p("div",{class:b(["item",P.value==t?"active":""]),key:t,"data-type":e.type,"data-index":t},w(e.name),11,ze))),64))])):m("",!0),H.value?(c(),h("div",{key:1,class:"list",onClick:We},[(c(),h(u,null,v(k,((e,t)=>p("div",{class:b(["item",O.value==t?"active":""]),key:t,"data-type":e.type},w(e.name),11,Se))),64))])):m("",!0)]),p("div",Pe,[p("div",Ne,[g(n,{activeKey:z.value,"onUpdate:activeKey":t[19]||(t[19]=e=>z.value=e),type:"card"},{default:x((()=>[g(o,{key:"0",tab:"对象设置"},{default:x((()=>[p("div",Ce,[g(i,{direction:"vertical"},{default:x((()=>[t[23]||(t[23]=p("h2",null,"位置",-1)),g(s,{prefix:"x：",value:j.position.x,"onUpdate:value":t[1]||(t[1]=e=>j.position.x=e),placeholder:"x",type:"number",disabled:-1==G.value,onChange:t[2]||(t[2]=e=>Ie(0,"position"))},null,8,["value","disabled"]),g(s,{prefix:"y：",value:j.position.y,"onUpdate:value":t[3]||(t[3]=e=>j.position.y=e),placeholder:"y",type:"number",disabled:-1==G.value,onChange:t[4]||(t[4]=e=>Ie(0,"position"))},null,8,["value","disabled"]),g(s,{prefix:"z：",value:j.position.z,"onUpdate:value":t[5]||(t[5]=e=>j.position.z=e),placeholder:"z",type:"number",disabled:-1==G.value,onChange:t[6]||(t[6]=e=>Ie(0,"position"))},null,8,["value","disabled"])])),_:1}),g(i,{direction:"vertical"},{default:x((()=>[t[24]||(t[24]=p("h2",null,"旋转",-1)),g(s,{prefix:"x：",value:j.rotation.x,"onUpdate:value":t[7]||(t[7]=e=>j.rotation.x=e),placeholder:"x",type:"number",disabled:-1==G.value,onChange:t[8]||(t[8]=e=>Ie(0,"rotation"))},null,8,["value","disabled"]),g(s,{prefix:"y：",value:j.rotation.y,"onUpdate:value":t[9]||(t[9]=e=>j.rotation.y=e),placeholder:"y",type:"number",disabled:-1==G.value,onChange:t[10]||(t[10]=e=>Ie(0,"rotation"))},null,8,["value","disabled"]),g(s,{prefix:"z：",value:j.rotation.z,"onUpdate:value":t[11]||(t[11]=e=>j.rotation.z=e),placeholder:"z",type:"number",disabled:-1==G.value,onChange:t[12]||(t[12]=e=>Ie(0,"rotation"))},null,8,["value","disabled"])])),_:1}),g(i,{direction:"vertical"},{default:x((()=>[t[25]||(t[25]=p("h2",null,"缩放",-1)),g(s,{prefix:"x：",value:j.scale.x,"onUpdate:value":t[13]||(t[13]=e=>j.scale.x=e),placeholder:"x",type:"number",disabled:-1==G.value,onChange:t[14]||(t[14]=e=>Ie(0,"scale"))},null,8,["value","disabled"]),g(s,{prefix:"y：",value:j.scale.y,"onUpdate:value":t[15]||(t[15]=e=>j.scale.y=e),placeholder:"y",type:"number",disabled:-1==G.value,onChange:t[16]||(t[16]=e=>Ie(0,"scale"))},null,8,["value","disabled"]),g(s,{prefix:"z：",value:j.scale.z,"onUpdate:value":t[17]||(t[17]=e=>j.scale.z=e),placeholder:"z",type:"number",disabled:-1==G.value,onChange:t[18]||(t[18]=e=>Ie(0,"scale"))},null,8,["value","disabled"])])),_:1})])])),_:1}),g(o,{key:"1",tab:"对象动画"},{default:x((()=>[p("div",ke,[(c(!0),h(u,null,v(f(U),((e,t)=>(c(),h("div",{class:b(["item",A.value===e?"active":""]),key:e,"data-name":e,onClick:De},w(e),11,He)))),128))])])),_:1})])),_:1},8,["activeKey"])]),p("div",Oe,[t[26]||(t[26]=p("h1",null,"对象集合",-1)),p("div",{class:"object-list",onClick:Be},[(c(!0),h(u,null,v(L,((e,t)=>(c(),h(u,{key:e.uuid},[e.visible?(c(),h("div",{key:0,class:b(["item",G.value===t?"active":""]),"data-index":t,"data-uuid":e.uuid,"data-type":e.type},w(e.name),11,je)):m("",!0)],64)))),128))])])]),p("div",Le,[p("div",{class:"mesh",ref_key:"dragRef",ref:J},[(c(),h(u,null,v(S,((e,s)=>p("div",{class:"mesh-item",key:s,"data-type":e.type,"data-url":e.url,"data-name":e.name,draggable:"true",onDragover:t[20]||(t[20]=y((()=>{}),["prevent"])),onDragstart:Re},w(e.name),41,Ge))),64))],512)]),B.value?(c(),h("div",_e,[p("div",Ue,[p("div",{class:"item",onClick:t[21]||(t[21]=(...e)=>f(ue).setVideoPlay&&f(ue).setVideoPlay(...e))},[g(a,null,{default:x((()=>[M(w(D.value?"暂停":"播放"),1)])),_:1})]),p("div",{class:"item",onClick:t[22]||(t[22]=(...e)=>f(ue).setVideoMuted&&f(ue).setVideoMuted(...e))},[g(a,null,{default:x((()=>[M("静音（"+w(R.value?"是":"否")+"）",1)])),_:1})])])])):m("",!0),p("div",Ae,[p("div",Ve,[g(a,{onClick:f(ue).prev},{default:x((()=>t[27]||(t[27]=[M("上一步")]))),_:1},8,["onClick"])]),p("div",Ee,[g(a,{onClick:f(ue).next},{default:x((()=>t[28]||(t[28]=[M("下一步")]))),_:1},8,["onClick"])]),p("div",Je,[g(a,{onClick:f(ue).exportData},{default:x((()=>t[29]||(t[29]=[M("导出")]))),_:1},8,["onClick"])])])],64)}}}),[["__scopeId","data-v-8830ad6b"]]),Be={class:"container",style:{width:"100%",height:"100%",display:"flex","background-color":"#000"}},De={class:"right",style:{width:"calc(100% - 100px)"}},Re={class:"content",style:{width:"100%",height:"calc(100% - 100px)",display:"flex"}},Fe=s({__name:"App",setup:e=>(e,t)=>(c(),h("div",Be,[t[1]||(t[1]=p("div",{class:"left",style:{width:"100px"}},null,-1)),p("div",De,[t[0]||(t[0]=p("div",{class:"nav",style:{height:"100px"}},null,-1)),p("div",Re,[g(We)])])]))}),Te={key:0,class:"loading"},qe={class:"progress"},$e=Ie(s({__name:"ProgressLoading",setup(e,{expose:t}){const s=i(0),o=i(!1);return t({onShow:()=>{o.value=!0},onHide:()=>{o.value=!1},onProgress:e=>{s.value=e}}),(e,t)=>(c(),z(S,{to:"body"},[o.value?(c(),h("div",Te,[p("div",qe,"加载进度..."+w(s.value)+"%",1)])):m("",!0)]))}}),[["__scopeId","data-v-12cf9b1b"]]),Ke={install(e){const t=document.createElement("div"),s=P($e).mount(t);e.config.globalProperties.$progressLoading={onShow(){s.onShow()},onHide(){s.onHide()},onProgress(e){s.onProgress(e)}}}},Xe=P(Fe);Xe.use(ue),Xe.use(Ke),Xe.mount("#app");
